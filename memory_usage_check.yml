---
 - hosts: test
   tasks: 
   - name: Memory usage check
     vars:
      THREASHHOLD: '50' 
      freemem: "{{ansible_memory_mb.real.used}}"
      mem: "{{ansible_memory_mb.real.total}}"
      used: "{{ (ansible_memory_mb.real.used * 100) / ansible_memory_mb.real.total | int }}"
     debug:
       msg: "memory usage above 50%"       
     when: used > THREASHHOLD
